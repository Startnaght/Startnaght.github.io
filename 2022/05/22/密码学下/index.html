<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>密码学下 | Serendipity</title><meta name="author" content="Serendipity,507566350@qq.com"><meta name="copyright" content="Serendipity"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="经典加密在数字计算机没有发明之前，加密都是对字符进行加密，一般采用的方法是字母替换，我把它称为 经典加密 。 凯撒密码简单的字母替换规则可以通过对字母表进行循环移位而来，最早记载的凯撒（Caesar）密码就是采用这种方式。凯撒密码是传说中的凯撒大帝发明，加密时将明文中的每个字母都按照其在字母表中的顺序向后移动固定数目生成密文。例如，当偏移量是右移3(+3)的时候形成下面的字母替换表：  +——+—">
<meta property="og:type" content="article">
<meta property="og:title" content="密码学下">
<meta property="og:url" content="http://yoursite.com/2022/05/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%8B/index.html">
<meta property="og:site_name" content="Serendipity">
<meta property="og:description" content="经典加密在数字计算机没有发明之前，加密都是对字符进行加密，一般采用的方法是字母替换，我把它称为 经典加密 。 凯撒密码简单的字母替换规则可以通过对字母表进行循环移位而来，最早记载的凯撒（Caesar）密码就是采用这种方式。凯撒密码是传说中的凯撒大帝发明，加密时将明文中的每个字母都按照其在字母表中的顺序向后移动固定数目生成密文。例如，当偏移量是右移3(+3)的时候形成下面的字母替换表：  +——+—">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/transparent">
<meta property="article:published_time" content="2022-05-22T11:58:36.000Z">
<meta property="article:modified_time" content="2022-06-24T02:45:51.189Z">
<meta property="article:author" content="Serendipity">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/transparent"><link rel="shortcut icon" href="/img/%E9%9B%AA%E5%B1%B1.png"><link rel="canonical" href="http://yoursite.com/2022/05/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-06-24 10:45:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Serendipity" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/tx.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-xingzhuangdianzhui"></use></svg><span> 小狐狸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-yezi-1"></use></svg><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/List/Music/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-yinle"></use></svg><span> Music</span></a></div><div class="menus_item"><a class="site-page" href="/List/Movie/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhuizhuiju"></use></svg><span> Movie</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-yezi-1"></use></svg><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofengwenfangsibaobimaobi_huaban_huaban"></use></svg><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/back/"><svg class="icon" aria-hidden="true"><use xlink:href="#iconfont icon-jilu"></use></svg><span> 关于我</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background: transparent"><nav id="nav"><span id="blog_name"><a id="site-name" onclick="btf.scrollToDest(0, 500)" data-title="欢迎光临糖果屋，愿你有愉快的一天">密码学下</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-xingzhuangdianzhui"></use></svg><span> 小狐狸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-yezi-1"></use></svg><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/List/Music/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-yinle"></use></svg><span> Music</span></a></div><div class="menus_item"><a class="site-page" href="/List/Movie/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhuizhuiju"></use></svg><span> Movie</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-yezi-1"></use></svg><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofengwenfangsibaobimaobi_huaban_huaban"></use></svg><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/back/"><svg class="icon" aria-hidden="true"><use xlink:href="#iconfont icon-jilu"></use></svg><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">密码学下</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-05-22T11:58:36.000Z" title="发表于 2022-05-22 19:58:36">2022-05-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-06-24T02:45:51.189Z" title="更新于 2022-06-24 10:45:51">2022-06-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="密码学下"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="经典加密"><a href="#经典加密" class="headerlink" title="经典加密"></a>经典加密</h2><p>在数字计算机没有发明之前，加密都是对字符进行加密，一般采用的方法是字母替换，我把它称为 经典加密 。</p>
<h2 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a>凯撒密码</h2><p>简单的字母替换规则可以通过对字母表进行循环移位而来，最早记载的凯撒（Caesar）密码就是采用这种方式。凯撒密码是传说中的凯撒大帝发明，加密时将明文中的每个字母都按照其在字母表中的顺序向后移动固定数目生成密文。例如，当偏移量是右移3(+3)的时候形成下面的字母替换表：</p>
<blockquote>
<p>+——+—————————————+<br>|明文|ABCDEFGHIJKLMNOPQRSTUVWXYZ|<br>+——+—————————————+<br>|密文|DEFGHIJKLMNOPQRSTUVWXYZABC|<br>+——+—————————————+</p>
</blockquote>
<p>对应我们的明文 <font color="red">GAME404</font> 就变成了密文 <font color="red"> JDPH404 </font>。解密时候再把密文在字母表中左移3(-3)得到明文 GAME404。这种情况下凯撒密码的秘钥就是单个数字3。</p>
<p>凯撒密码现在看来是比较小儿科，但是在2000多年前，是了不起的发明，为凯撒部队的保密工作做了贡献。即使是到现在，军事上的信息保密需求，任然是密码学前进的最大动力。</p>
<blockquote>
<p>这里数字忽略加密，采用原文传输</p>
</blockquote>
<h2 id="ROT13加密"><a href="#ROT13加密" class="headerlink" title="ROT13加密"></a>ROT13加密</h2><p>rot13（rotate by 13 places）也是一种简易的替换式密码，是凯撒密码的变种。rot13将明文偏移13位形成密文，因为英文总共26位，所以密文再偏移13位后会循环回到原文，非常巧妙的设计，加密和解密使用同一个方法。这是公式:  <font color="red">rot13(rot13(xxx))=xxx</font>。在python3中默认带rot_13的算法实现, 下面是用例:</p>
<blockquote>
<p>➜  ~ echo “game404” | python -m encodings.rot_13<br>tnzr404<br>➜  ~ echo “tnzr404” | python -m encodings.rot_13<br>game404</p>
</blockquote>
<h2 id="随机单表替换"><a href="#随机单表替换" class="headerlink" title="随机单表替换"></a>随机单表替换</h2><p>采用位移形成的字母替换，有明显的规律。加密中最要的一点是 随机 ，所以可以使用随机的方式形成字母替换表:</p>
<blockquote>
<p>+——+—————————————+<br>|明文|ABCDEFGHIJKLMNOPQRSTUVWXYZ|<br>+——+—————————————+<br>|密文|ZEBRASCDFGHIJKLMNOPQTUVWXY|<br>+——+—————————————+</p>
</blockquote>
<p>这样加密和解密都必须持有  <font color="red">ZEBRASCDFGHIJKLMNOPQTUVWXY</font> 这个完整的密码本，长度为26位，而不是3或者13这样的单位秘钥。<br>随机单表替换，初看无法得到具体信息。但是一些密码破译专家，也是数学家就可以看到一些统计规律。比如明文 hello game 加密后的密文  <font color="red">daiil czja</font>。因为在英语中字母e是频率最高的字符，根据前面的密文表现，可以初步推断 e-&gt;a。如果我们再掌握更多的密文，分析其中的统计规律，使用类似求解数独的方式，破译密码。</p>
<h2 id="维吉尼亚多表替换密码"><a href="#维吉尼亚多表替换密码" class="headerlink" title="维吉尼亚多表替换密码"></a>维吉尼亚多表替换密码</h2><p>单表替换容易透露统计规律，自然的改进思路就是使用多表替换，每个字母采用不同的替换规则，让规律不好捉摸。比如下面的维吉尼亚多表:<br><img src="img/维吉尼亚多表替换.png"></p>
<blockquote>
<p>此密码曾被误以为由布莱斯•德•维吉尼亚所创，所以才叫作维吉尼亚密码，实际上最著名的一种为吉奥万•巴蒂斯塔•贝拉索于1585年推出。它于1863年之前一直未被破解。法国人称它作“不能破译的密码”。<br>维吉尼亚密码中,表格的第一行只需直接填上26个字母,然后以下每一行的字母都是向左偏移一格，形成对称结构。这叫作表格横移,数学上每一列同余26。<br>这种密码需要使用一个关键字来作为密钥，关键字按字循环使用。</p>
</blockquote>
<p>假设关键字是CAT,明文的第一个字由C加密,第二个字由A加密,第三个则由T加密,然后再回到C加密,一直重复。加密按照上边的密码表,例如明文BALL用CAT作关键字时会得到密文DAEN,同一个字母L会加密成2个不同字母EN。现实中,维吉尼亚密码的关键字非常长，破解难度提高了很多。<br>维吉尼亚密码的密码本是规则的，所以破解的关键在于找到关键字。具体破解办法还是要从统计规律入手，进行暴力破解。<br>恩尼格玛密码机<br>人为制作的密码本是规则且有限，所以聪明的人想出了制作密码机器。恩尼格玛密码机(德語：Enigma)是第二次世界大战时的纳粹德国使用的密码机。关于恩尼格玛密码机和图灵的故事非常精彩和传奇，也有很多文章介绍。这里我只是简单介绍一小小部分。恩尼格玛密码机大概长这样:</p>
<p>看起来和一个机械打字机类似，顶部的转子用来旋转设置秘钥，转子内部自动生成不同的密码表，底部的键盘用来键入明文，每个明文经过机器转换加密后输出到中间的灯泡，记录下灯泡的位置就得到密文。解密的时候设置好相同的转子位置，然后输入密文，就得到了明文。<br>因为恩尼格玛密码机加密非常复杂，不犯错的情况下人肉难以快速破解。所以后来大神图灵登场，设计了“炸弹机”，用机器来破解机器，从此开启了计算机的新时代。<br>数字加密<br>在数字世界里，字符不再是不可分割。经典场景中字符A是原子的，没法拆分成左半个A和右半个A。数字世界0和1才是原子的，字符可以分解成不同的0和1组合，比如:</p>
<blockquote>
<blockquote>
<blockquote>
<p>a = “a”<br>print(a, ord(a), bin(ord(a)))<br>a 97 0b1100001</p>
</blockquote>
</blockquote>
</blockquote>
<p>字符a的ASCII码是97，对应的二进制是8位001100001。这样我们就可以把a打散成两部分，比如左边6位0011000，右边2位01，再和别的字符重新排列。<br>base64<br>所谓Base64，就是说选出64个字符——小写字母a-z、大写字母A-Z、数字0-9、符号”+”、”/“（再加上作为垫字的”=”，实际上是65个字符）——作为一个基本字符集。然后，其他所有符号都转换成这个字符集中的字符。这种加密方式因为密码本公开，所以一般只是称为base64 编码，而不叫做base64 加密。<br>阮一峰老师的Base64笔记介绍的非常好，大家可以通过尾部的参考链接去查看。我偷懒简单整理一下。先是base64的码表:<br>码值    字符    码值    字符    码值    字符    码值    字符<br>0    A    16    Q    32    g    48    w<br>1    B    17    R    33    h    49    x<br>2    C    18    S    34    i    50    y<br>3    D    19    T    35    j    51    z<br>4    E    20    U    36    k    52    0<br>5    F    21    V    37    l    53    1<br>6    G    22    W    38    m    54    2<br>7    H    23    X    39    n    55    3<br>8    I    24    Y    40    o    56    4<br>9    J    25    Z    41    p    57    5<br>10    K    26    a    42    q    58    6<br>11    L    27    b    43    r    59    7<br>12    M    28    c    44    s    60    8<br>13    N    29    d    45    t    61    9<br>14    O    30    e    46    u    62    +<br>15    P    31    f    47    v    63    /</p>
<p>然后部分ASCII码表:<br>二进制    十进制    十六进制    图形<br>…<br>0100 1101    77    4D    M<br>…<br>0110 0001    97    61    a<br>…<br>0110 1110    110    6E    n</p>
<p>那么base64的编码过程如下:</p>
<p>AESDESAES 代表高级加密标准Advanced Encryption StandardDES代表数据加密标准Data Encryption Standard创作日期为1999年。创作日期为1976年。面向字节。面向位。密钥长度可以是 128 位、192 位和 256 位。DES 中的密钥长度为 56 位。轮数取决于密钥长度：10（128 位）、12（192 位）或 14（256 位）DES涉及16轮相同操作该结构基于置换-置换(substitution-permutation)网络。该结构基于Feistel网络。AES 的设计原理是开放的。DES 的设计原理是封闭的。对此的选择过程是秘密的，但接受了公开的公众评论。选择过程是秘密的。AES 比 DES 密码更安全，是事实上的世界标准。DES 很容易被破解，因为它有已知的漏洞。3DES（三重 DES）是 DES 的一种变体，它比通常的 DES 更安全。AES 中的轮次是：字节替换、移位行、混合列和密钥加法DES 中的轮是：扩展、使用轮密钥的 XOR 操作、替换和置换AES 可以加密 128 位的明文。DES 可以加密 64 位的明文。AES 密码是从旁通道方密码派生的。DES密码源自路西法密码。AES 由 Vincent Rijmen 和 Joan Daemen 设计。DES 由 IBM 设计。没有已知的针对 AES 的密码分析攻击，但可能会针对 AES 实施进行侧信道攻击。Biclique 攻击比蛮力攻击具有更好的复杂性，但仍然无效。针对 DES 的已知攻击包括暴力破解、线性密码分析和差分密码分析。<br>DES的算法比较复杂，我简单总结一下大概步骤：</p>
<p>准备64位的明文和64位的密钥<br>秘钥经过16次调度，形成16个子秘钥<br>每个子秘钥，通过从秘钥64位摘取56位，分成左右各28位的L端和R端。然后L端和R端各自左移指定轮次的位数，然后拼接L端和R端。这个过程是字节的重组。最后对形成的秘钥在进行一次置换。得到48位的子秘钥。<br>重复上面的步骤3，直到得到16个48位子秘钥<br>明文的64位根据置换表进行一次置换，再拆分成L端和R端各32位<br>循环执行L，R = R，F(L，子秘钥)16次，就是把R端复制给L，然后把32位的L和48位的子秘钥使用f函数进行加密。<br>最后把L和R拼接后进行再进行一次置换得到密文</p>
<p>可以看到算法中关键点, F函数。 Feistel函数重点是把32位的一半明文和48位的子秘钥，混合得出一个32位的等长秘钥。这个过程依赖一个不透明的预制机制S盒，所以其实不收大家信任，怀疑算法留有后门。这个过程，我们可以把它想象成接水管游戏，不同的输入经过内部管道处理，输出特定的结果:</p>
<p>DES加密的思想，总结起来就是二进制位的重组和替换。DES和AES都是成熟的算法，一般情况下我们不需要实现它。出于安全性考虑，DES已经弃用，现在实际业务中一般直接利用AES的API即可。下面是完整的实现:<br>from base64 import b64encode, b64decode<br>from Crypto.Cipher import AES<br>from Crypto.Util.Padding import pad, unpad</p>
<p>def ase_cbc():<br>    data = b”secret”<br>    key = b”jSOlan6Co5Ac2HiT”<br>    cipher = AES.new(key, AES.MODE_CBC, iv=key[:AES.block_size])<br>    ct_bytes = cipher.encrypt(pad(data, AES.block_size))<br>    ciphertext = b64encode(ct_bytes).decode(‘utf-8’)<br>    print(ciphertext)<br>    ct = b64decode(b64encode(ct_bytes).decode())<br>    cipher = AES.new(key, AES.MODE_CBC, iv=key[:AES.block_size])<br>    dat = unpad(cipher.decrypt(ct), AES.block_size)<br>    print(dat)</p>
<p> svhpgz4vi1AgHDtdt8aaww==<br> b’secret’</p>
<p>明文是6个字节，秘钥是16个字节<br>创建一个ase的算法实现，这使用cbc模式<br>使用pad方法先对明文数据进行补齐<br>对明文进行加密得到密文，密文是二进制<br>因为二进制密文打印会乱码，所以将其使用base64编码转换成ascii字符<br>解密则是加密的逆过程</p>
<p>非对称加密算法<br>前一篇文章介绍过非对称加密的一些思路，和对称加密不同的是秘钥分成一个秘钥对：私钥+公钥。公钥用于加密，私钥永于解密。在介绍非对称加密的算法实现之前，我们先看看物理世界的非对称加密模拟，有助于我们理解非对称加密的基本逻辑。</p>
<p>上面是我简单画的一个非对称加密信箱，分成上下2个盒子，中间是联通的。上方盒子需要使用四角星的钥匙打开，下方盒子需要使用五角星的的钥匙打开。那么一个信息加密传输过程大概如下:</p>
<p>发送方甲用自己的锁把上方盒子用四角星锁锁住，然后把信箱传递给接收方乙。<br>接收方乙收到信箱后把下方盒子用五角星锁锁住，然后把信息回传给发送方甲。<br>甲用四角星钥匙打开上方盒子，塞入信件，然后把信箱和信件一起传递给乙。<br>乙用五角星钥匙打开下方盒子，取出信件。完成一次信息加密传输。</p>
<p>在这个信息传递过程中，甲乙的钥匙都分别自己保管，没有经过运输。甲用四角星钥匙加锁，乙用五角星钥匙解锁，而且信件都在信箱中。这样保证了信息传递是安全的。<br>1977年，三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，可以实现非对称加密。这种算法用他们三个人的名字命名，叫做RSA算法，现在是非对称加密的标准。算法主要采用的是质数因式分解这样一个”盒子”比如下面一个等式:<br>n = 61×53 = 3233</p>
<p>61和53的乘积，大家口算或者笔算有可能可以计算出来，但是反过来求3233是那两个质数的乘积却非常难。在非对称加密情况下，我们选择一个随机数，比如17。使用(3233，17)这样的信息组成公钥，然后使用类似(3233,17<em>61/17</em>65)这样的信息组成私钥。公钥只是私钥的一部分信息，这样公钥加密的信息，逻辑上私钥肯定可以解密。而且通过公钥的3233，很难推断出私钥中的61*53。当然非对称加密的数学验证比这个举例要严谨和复杂的多，我这里只是尝试举例，帮助理解。<br>加密示例:<br>def rsa_enc():<br>    from Crypto.PublicKey import RSA<br>    from Crypto.Random import get_random_bytes<br>    from Crypto.Cipher import AES, PKCS1_OAEP</p>
<pre><code>data = &quot;I met aliens in UFO. Here is the map.&quot;.encode(&quot;utf-8&quot;)
file_out = open(&quot;encrypted_data.bin&quot;, &quot;wb&quot;)

recipient_key = RSA.import_key(open(&quot;public.pem&quot;).read())
session_key = get_random_bytes(16)

# Encrypt the session key with the public RSA key
cipher_rsa = PKCS1_OAEP.new(recipient_key)
enc_session_key = cipher_rsa.encrypt(session_key)

# Encrypt the data with the AES session key
cipher_aes = AES.new(session_key, AES.MODE_EAX)
ciphertext, tag = cipher_aes.encrypt_and_digest(data)
[file_out.write(x) for x in (enc_session_key, cipher_aes.nonce, tag, ciphertext)]
file_out.close()
</code></pre><p>秘钥可以使用代码生成，也可以使用OpenSSL工具生成，这里我使用上一篇文章中的秘钥<br>导入rsa公钥<br>随机一个AES秘钥，然后使用rsa公钥加密这个秘钥<br>使用AES加密信息<br>将AES秘钥密文，AES的随机数，iv和密文写入结果</p>
<p>解密示例:<br>from Crypto.PublicKey import RSA<br>from Crypto.Cipher import AES, PKCS1_OAEP</p>
<p>file_in = open(“encrypted_data.bin”, “rb”)</p>
<p>private_key = RSA.import_key(open(“private.pem”).read())</p>
<p>enc_session_key, nonce, tag, ciphertext = \<br>   [ file_in.read(x) for x in (private_key.size_in_bytes(), 16, 16, -1) ]</p>
<p> Decrypt the session key with the private RSA key<br>cipher_rsa = PKCS1_OAEP.new(private_key)<br>session_key = cipher_rsa.decrypt(enc_session_key)</p>
<p> Decrypt the data with the AES session key<br>cipher_aes = AES.new(session_key, AES.MODE_EAX, nonce)<br>data = cipher_aes.decrypt_and_verify(ciphertext, tag)<br>print(data.decode(“utf-8”))</p>
<p>导入rsa私钥<br>读取结果，并按位从中解析出aes私钥密文，随机数，iv和剩下的密文信息<br>使用rsa私钥从aes秘钥的密文中解析出aes密钥明文<br>使用aes秘钥解密密文信息</p>
<p>这一对过程的重点是，rsa仅仅加密aes的私钥，私钥的密文进行传输 。encrypted_data.bin是二进制的，直接使用文本方式查看会是乱码，我们可以转换为base64方式查看:<br>✗ base64 encrypted_data.bin<br>w+ii4VVphO1ulHjrUy4fcc7CuLxaxJTQuzTtgIqvoot3ivBcRWwxV/1rNqIA2fsddYq8AIRo7jV9xoxbUK9ll8LQdM5S0N9eBakM6wzEwnN9PFrJEKN7VdmTqxnzC7go5tS2qNR173xcJKTX3UXKBTLbKXkafj9k2Bk9g93hRh19Uka/S5AqD43dFjIyI2ogxZNkN0v5E6uAyINlhGO8jCHAN0yhu4S5zz0ph7mFAVfXQkNDuotcdmsRfPpEi641BI/fEGE=</p>
<p>散列算法<br>散列函数（Hash function）又称散列算法、哈希函数，是一种从任何一种数据中创建小的数字“指纹”的方法。散列函数把消息或数据压缩成摘要，使得数据量变小，将数据的格式固定下来。该函数将数据打乱混合，重新创建一个叫做散列值（hash values，hash codes，hash sums，或hashes）的指纹。散列值通常用一个短的随机字母和数字组成的字符串来代表，用来表示信息完整性。<br>散列函数数学逻辑并不难，首先需要一个奇函数，保证每一个输入可以得到一个唯一的输出:</p>
<p>然后我们再从输出结果中进行信息摘取部分，这样来保证摘要比原文要短，因为摘要比原文长，那就没有价值。我们可以自己随便设想一个哈希算法:</p>
<p>函数取值 y=2f(x)+3<br>将结果转换为二进制后循环左移3位<br>将二进制结果拆分成左右两段并还原成2个十进制数<br>使用2个十进制数相乘<br>结果再转换为二进制数据，取其前8位转换成16进制得到哈希值</p>
<p>根据抽屉原理，9个苹果放到8个箱子，一定有一个箱子会有2个苹果。信息摘要算法一定会有冲突，只是好的算法信息冲突的概率会非常非常低。我们上面的设想的哈希算法，仅仅8位，冲突的概率非常高。好的散列函数在输入域中很少出现散列冲突，知名的算法有MD5和SHA。<br>MD5信息摘要演算法5（MD5 Message-Digest Algorithm 5）是散列算法的一种，可以产生出一個128位（16个字节(BYTES)）的散列值（hash value），一般表示为32位十六进制数字。<br>SHA安全散列算法（Secure Hash Algorithm ）也是一个系列的散列算法。最早SHA-1，正式发布的第一代算法可以生成一个被称为消息摘要的160位（20字节）散列值，散列值通常的呈现形式为40个十六进制数。<br>这两种算法都被我国的 王小云 教授破解了，所以这2种算法都被认为安全性不足，不再建议使用，目前较多使用sha256算法。sha256是sha-2算法的变种，输出是256位(32字节)的摘要值，同属sha-2的还有SHA-224，SHA-512等。2015年还推出了sha算法的第3个版本，即sha3。<br>下面是md5和sha256的示例:<br>def hash_sample():<br>    import hashlib<br>    plaintext = “game404”<br>    result = hashlib.md5(plaintext.encode())<br>    md5 = result.hexdigest()<br>    print(md5, len(md5))<br>    result = hashlib.sha256(plaintext.encode())<br>    s256 = result.hexdigest()<br>    print(s256, len(s256))</p>
<h1 id="e935208860777d1584d3586a9e93e160-32"><a href="#e935208860777d1584d3586a9e93e160-32" class="headerlink" title="e935208860777d1584d3586a9e93e160 32"></a>e935208860777d1584d3586a9e93e160 32</h1><h1 id="c56afda14db3e8b61eb83f17540401ec983e91e92375826d2842e29c8a4db437-64"><a href="#c56afda14db3e8b61eb83f17540401ec983e91e92375826d2842e29c8a4db437-64" class="headerlink" title="c56afda14db3e8b61eb83f17540401ec983e91e92375826d2842e29c8a4db437 64"></a>c56afda14db3e8b61eb83f17540401ec983e91e92375826d2842e29c8a4db437 64</h1><p>license实现<br>了解完所有算法的模型后，license的实现就非常简单了。我们先设置license信息:<br>{<br>    “name”:”game404”，<br>    “expiryDate”: 20220220<br>}</p>
<p>然后我们将其dump成字符后使用ras签名, 完整代码如下:<br>def rsa_sign():<br>    from Crypto.PublicKey import RSA<br>    from Crypto.Cipher import AES<br>    from Crypto.Signature import PKCS1_v1_5<br>    from Crypto.Hash import SHA256<br>    import json</p>
<pre><code>license_object = &#123;
    &quot;name&quot;: &quot;game404&quot;,
    &quot;expiryDate&quot;: 20220220
&#125;
plaintext = json.dumps(license_object)
file_out = open(&quot;encrypted_license.bin&quot;, &quot;wb&quot;)
private_key = RSA.import_key(open(&quot;private.pem&quot;).read())
# rsa签名
cipher_rsa = PKCS1_v1_5.new(private_key)
digest = SHA256.new()
digest.update(plaintext.encode(&quot;utf-8&quot;))
signature = cipher_rsa.sign(digest)
# aes加密
session_key = get_random_bytes(16)
cipher_aes = AES.new(session_key, AES.MODE_EAX)
ciphertext, tag = cipher_aes.encrypt_and_digest(plaintext.encode(&quot;utf-8&quot;))
# 写license
file_out.write(b&quot;&quot;.join([session_key, cipher_aes.nonce, tag, signature, ciphertext]))
file_out.close()
</code></pre><p>证书我们可以base64后发送出去:<br>F4IBtZOODAE5XSdluFynrk8e01gSKwVftivMg+eucfD7j5nCdMZhIcjGyLjQ5miV4Y6mAOooajNypWVL+GTVleXoLUQzqf0hLG02ytuIZ3QlCbGXVn3sofePq+IhwDBH5x2CECwHofzuNH0LbQLlW7LbwXxOl8xvGOw1gCvUgGo8Uuqli0cgrijqKO+n72Rb4Is0KW8EMjvPvaaLodbEhUc2iCLDiDDLXpBvcWsMZeW+AVgfpr6jKR9ICyELg4XQ2s84gs3d+EcFjaFjAzwygBuLYdqa40pR4G/e</p>
<p>本地验证证书:<br>def rsa_verify():<br>    from Crypto.PublicKey import RSA<br>    from Crypto.Cipher import AES<br>    from Crypto.Signature import PKCS1_v1_5<br>    from Crypto.Hash import SHA256</p>
<pre><code>file_in = open(&quot;encrypted_license.bin&quot;, &quot;rb&quot;)

public_key = RSA.import_key(open(&quot;public.pem&quot;).read())
# 读取license
session_key, nonce, tag, signature, ciphertext = [file_in.read(x) for x in (16, 16, 16, 128, -1)]

# aes解密
cipher_aes = AES.new(session_key, AES.MODE_EAX, nonce)
data = cipher_aes.decrypt_and_verify(ciphertext, tag)
print(data.decode(&quot;utf-8&quot;))

cipher_rsa = PKCS1_v1_5.new(public_key)
digest = SHA256.new()
digest.update(data)
try:
    # 验证签名
    cipher_rsa.verify(digest, signature)
except ValueError:
    pass
</code></pre><p>证书实际上不需要保密，只需要验证来源的合法性和完整性。所以我们可以看到aes的秘钥是写入到证书文件中的，合法性和完整性使用rsa算法和sha256算法结合来保证。<br>小结<br>本文我们一起回顾了经典加密和数字加密的演化过程，学习了使用 随机 ，变换 和 重组 等方式构建加密算法。重点了解了aes对称加密算法，rsa非对称加密算法以及sha256摘要算法，并利用它实现了一个商业license的制作。<br>数字加密的尽头，可能是量子计算。首先是量子通讯的不可观测性让量子加密具有巨大优势，如果通讯被偷听会导致量子叠加的坍缩，这样还可以主动识别是否被偷听。这个主动防窃听就非常厉害了，是上面的经典计算机的加密算法都无法实现的。其次量子计算机，在并行计算上也有巨大优势，经典计算机无法快速破解的算法，对量子计算机可能秒破。保密和破解这一矛和盾，又将迎来新的一轮变更。<br>最后，最重要的是我国在量子领域处于第一梯队，起步不晚，发展迅速。从md5的破解，再到量子通讯/计算，中国科学家逐渐登场，以后一定会看到更多 中国名字 和 中国标准 。<br>参考链接</p>
<p>DES算法原理及实现 www.ruanx.net/des/<br>什么是DES加密 www.cxyxiaowu.com/1478.html<br>费斯妥密码 zh.wikipedia.org/wiki/%E8%B4…<br>Feistel Cipher kysonlok.gitbook.io/blog/crypto…<br>Difference between AES and DES ciphers www.geeksforgeeks.org/difference-…<br>维吉尼亚多表替换加密术 sca.gov.cn/sca/zxfw/20…<br>zh.wikipedia.org/wiki/%E6%81…<br>Base64笔记 www.ruanyifeng.com/blog/2008/0…<br>XOR 加密简介 www.ruanyifeng.com/blog/2017/0…<br>pycryptodome.readthedocs.io/en/latest/s…</p>
<p>作者：游戏不存在<br>链接：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7066794630422986788">https://juejin.cn/post/7066794630422986788</a><br>来源：稀土掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:507566350@qq.com">Serendipity</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2022/05/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%8B/">http://yoursite.com/2022/05/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">Serendipity</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/transparent" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/06/24/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"><img class="prev-cover" src="/transparent" onerror="onerror=null;src='/'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">学习计划</div></div></a></div><div class="next-post pull-right"><a href="/2022/05/22/%E5%AF%86%E7%A0%81%E5%AD%A6/"><img class="next-cover" src="/transparent" onerror="onerror=null;src='/'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">密码学</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/tx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Serendipity</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">殷勤昨夜三更雨，又得浮生一日凉</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%8F%E5%85%B8%E5%8A%A0%E5%AF%86"><span class="toc-number">1.</span> <span class="toc-text">经典加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">凯撒密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROT13%E5%8A%A0%E5%AF%86"><span class="toc-number">3.</span> <span class="toc-text">ROT13加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%8D%95%E8%A1%A8%E6%9B%BF%E6%8D%A2"><span class="toc-number">4.</span> <span class="toc-text">随机单表替换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%A4%9A%E8%A1%A8%E6%9B%BF%E6%8D%A2%E5%AF%86%E7%A0%81"><span class="toc-number">5.</span> <span class="toc-text">维吉尼亚多表替换密码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#e935208860777d1584d3586a9e93e160-32"><span class="toc-number"></span> <span class="toc-text">e935208860777d1584d3586a9e93e160 32</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#c56afda14db3e8b61eb83f17540401ec983e91e92375826d2842e29c8a4db437-64"><span class="toc-number"></span> <span class="toc-text">c56afda14db3e8b61eb83f17540401ec983e91e92375826d2842e29c8a4db437 64</span></a></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/10/%E9%AD%94%E6%94%B9%E8%AE%B0%E5%BD%95/" title="魔改记录"><img src="/transparent" onerror="this.onerror=null;this.src='/'" alt="魔改记录"/></a><div class="content"><a class="title" href="/2024/09/10/%E9%AD%94%E6%94%B9%E8%AE%B0%E5%BD%95/" title="魔改记录">魔改记录</a><time datetime="2024-09-10T06:52:04.000Z" title="发表于 2024-09-10 14:52:04">2024-09-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/25/java-%E9%9B%86%E5%90%88/" title="java-集合"><img src="/transparent" onerror="this.onerror=null;this.src='/'" alt="java-集合"/></a><div class="content"><a class="title" href="/2022/06/25/java-%E9%9B%86%E5%90%88/" title="java-集合">java-集合</a><time datetime="2022-06-25T04:25:06.000Z" title="发表于 2022-06-25 12:25:06">2022-06-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/24/java-%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%92%8C%E6%B3%A8%E8%A7%A3/" title="java-枚举类和注解"><img src="/transparent" onerror="this.onerror=null;this.src='/'" alt="java-枚举类和注解"/></a><div class="content"><a class="title" href="/2022/06/24/java-%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%92%8C%E6%B3%A8%E8%A7%A3/" title="java-枚举类和注解">java-枚举类和注解</a><time datetime="2022-06-24T10:48:52.000Z" title="发表于 2022-06-24 18:48:52">2022-06-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/24/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" title="学习计划"><img src="/transparent" onerror="this.onerror=null;this.src='/'" alt="学习计划"/></a><div class="content"><a class="title" href="/2022/06/24/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" title="学习计划">学习计划</a><time datetime="2022-06-24T02:19:01.000Z" title="发表于 2022-06-24 10:19:01">2022-06-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%8B/" title="密码学下"><img src="/transparent" onerror="this.onerror=null;this.src='/'" alt="密码学下"/></a><div class="content"><a class="title" href="/2022/05/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%8B/" title="密码学下">密码学下</a><time datetime="2022-05-22T11:58:36.000Z" title="发表于 2022-05-22 19:58:36">2022-05-22</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Serendipity</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})
setTimeout(function(){preloader.endLoading();}, 3000);</script></div><div class="js-pjax"></div><script async src="//at.alicdn.com/t/font_2784788_tud88ihttq.js"></script><script defer src="/live2d-widget/autoload.js"></script><script src="/js/bj/background.js"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>